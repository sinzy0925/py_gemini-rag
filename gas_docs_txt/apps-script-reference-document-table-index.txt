Source Path: gas_docs_html/apps-script/reference/document/table/index.html

AI-generated Key Takeaways
outlined_flag
A
Table
element can only contain
TableRow
elements.
Tables can be efficiently built from a string array, especially for large tables.
Various methods are available to manipulate
Table
elements, including appending and inserting rows, clearing content, copying, editing as text, finding elements or text, and managing attributes and formatting like borders and column widths.
Methods for navigating the document structure, such as getting children and siblings, and checking if the element is at the document end are also provided.
You can remove rows or the entire table element using specific methods.
Text within the table can be replaced using regular expressions, and text alignment can be set.
Table
An element representing a table. A
Table
may only contain
Table
Row
elements. For
more information on document structure, see the
guide to extending Google Docs
.
When creating a
Table
that contains a large number of rows or cells, consider building
it from a string array, as shown in the following example.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Create a two-dimensional array containing the cell contents.
const
cells
=
[
[
'Row 1, Cell 1'
,
'Row 1, Cell 2'
],
[
'Row 2, Cell 1'
,
'Row 2, Cell 2'
],
];
// Build a table from the array.
body
.
appendTable
(
cells
);
Methods
Method
Return type
Brief description
append
Table
Row()
Table
Row
Creates and appends a new
Table
Row
.
append
Table
Row(tableRow)
Table
Row
Appends the given
Table
Row
.
clear()
Table
Clears the contents of the element.
copy()
Table
Returns a detached, deep copy of the current element.
edit
As
Text()
Text
Obtains a
Text
version of the current element, for editing.
find
Element(elementType)
Range
Element
Searches the contents of the element for a descendant of the specified type.
find
Element(elementType, from)
Range
Element
Searches the contents of the element for a descendant of the specified type, starting from the
specified
Range
Element
.
find
Text(searchPattern)
Range
Element
Searches the contents of the element for the specified text pattern using regular expressions.
find
Text(searchPattern, from)
Range
Element
Searches the contents of the element for the specified text pattern, starting from a given
search result.
get
Attributes()
Object
Retrieves the element's attributes.
get
Border
Color()
String
Retrieves the border color.
get
Border
Width()
Number
Retrieves the border width, in points.
get
Cell(rowIndex, cellIndex)
Table
Cell
Retrieves the
Table
Cell
at the specified row and cell indices.
get
Child(childIndex)
Element
Retrieves the child element at the specified child index.
get
Child
Index(child)
Integer
Retrieves the child index for the specified child element.
get
Column
Width(columnIndex)
Number
Retrieves the width of the specified table column, in points.
get
Link
Url()
String
Retrieves the link url.
get
Next
Sibling()
Element
Retrieves the element's next sibling element.
get
Num
Children()
Integer
Retrieves the number of children.
get
Num
Rows()
Integer
Retrieves the number of
Table
Rows
.
get
Parent()
Container
Element
Retrieves the element's parent element.
get
Previous
Sibling()
Element
Retrieves the element's previous sibling element.
get
Row(rowIndex)
Table
Row
Retrieves the
Table
Row
at the specified row index.
get
Text()
String
Retrieves the contents of the element as a text string.
get
Text
Alignment()
Text
Alignment
Gets the text alignment.
get
Type()
Element
Type
Retrieves the element's
Element
Type
.
insert
Table
Row(childIndex)
Table
Row
Creates and inserts a new
Table
Row
at the specified index.
insert
Table
Row(childIndex, tableRow)
Table
Row
Inserts the given
Table
Row
at the specified index.
is
At
Document
End()
Boolean
Determines whether the element is at the end of the
Document
.
remove
Child(child)
Table
Removes the specified child element.
remove
From
Parent()
Table
Removes the element from its parent.
remove
Row(rowIndex)
Table
Row
Removes the
Table
Row
at the specified row index.
replace
Text(searchPattern, replacement)
Element
Replaces all occurrences of a given text pattern with a given replacement string, using regular
expressions.
set
Attributes(attributes)
Table
Sets the element's attributes.
set
Border
Color(color)
Table
Sets the border color.
set
Border
Width(width)
Table
Sets the border width, in points.
set
Column
Width(columnIndex, width)
Table
Sets the width of the specified column, in points.
set
Link
Url(url)
Table
Sets the link url.
set
Text
Alignment(textAlignment)
Table
Sets the text alignment.
Detailed documentation
append
Table
Row()
Creates and appends a new
Table
Row
.
Return
Table
Row
— the new table row element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
append
Table
Row(tableRow)
Appends the given
Table
Row
.
// Opens the Docs file by its ID. If you created your script from within a
// Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first table in the tab and copies the second row.
const
table
=
body
.
getTables
()[
0
];
const
row
=
table
.
getChild
(
1
).
copy
();
// Adds the copied row to the bottom of the table.
const
tableRow
=
table
.
appendTableRow
(
row
);
Parameters
Name
Type
Description
table
Row
Table
Row
The table row to append.
Return
Table
Row
— The appended table row element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
clear()
Clears the contents of the element.
Return
Table
— The current element.
copy()
Returns a detached, deep copy of the current element.
Any child elements present in the element are also copied. The new element doesn't have a
parent.
Return
Table
— The new copy.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
edit
As
Text()
Obtains a
Text
version of the current element, for editing.
Use
edit
As
Text
for manipulating the elements contents as rich text. The
edit
As
Text
mode ignores non-text elements (such as
Inline
Image
and
Horizontal
Rule
).
Child elements fully contained within a deleted text range are removed from the element.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Insert two paragraphs separated by a paragraph containing an
// horizontal rule.
body
.
insertParagraph
(
0
,
'An editAsText sample.'
);
body
.
insertHorizontalRule
(
0
);
body
.
insertParagraph
(
0
,
'An example.'
);
// Delete " sample.\n\n An" removing the horizontal rule in the process.
body
.
editAsText
().
deleteText
(
14
,
25
);
Return
Text
— a text version of the current element
find
Element(elementType)
Searches the contents of the element for a descendant of the specified type.
Parameters
Name
Type
Description
element
Type
Element
Type
The type of element to search for.
Return
Range
Element
— A search result indicating the position of the search element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
find
Element(elementType, from)
Searches the contents of the element for a descendant of the specified type, starting from the
specified
Range
Element
.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Define the search parameters.
let
searchResult
=
null
;
// Search until the paragraph is found.
while
(
(
searchResult
=
body
.
findElement
(
DocumentApp
.
ElementType
.
PARAGRAPH
,
searchResult
,
)))
{
const
par
=
searchResult
.
getElement
().
asParagraph
();
if
(
par
.
getHeading
()
===
DocumentApp
.
ParagraphHeading
.
HEADING1
)
{
// Found one, update and stop.
par
.
setText
(
'This is the first header.'
);
break
;
}
}
Parameters
Name
Type
Description
element
Type
Element
Type
The type of element to search for.
from
Range
Element
The search result to search from.
Return
Range
Element
— A search result indicating the next position of the search element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
find
Text(searchPattern)
Searches the contents of the element for the specified text pattern using regular expressions.
A subset of the JavaScript regular expression features are not fully supported, such as
capture groups and mode modifiers.
The provided regular expression pattern is independently matched against each text block
contained in the current element.
Parameters
Name
Type
Description
search
Pattern
String
the pattern to search for
Return
Range
Element
— a search result indicating the position of the search text, or null if there is no
    match
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
find
Text(searchPattern, from)
Searches the contents of the element for the specified text pattern, starting from a given
search result.
A subset of the JavaScript regular expression features are not fully supported, such as
capture groups and mode modifiers.
The provided regular expression pattern is independently matched against each text block
contained in the current element.
Parameters
Name
Type
Description
search
Pattern
String
the pattern to search for
from
Range
Element
the search result to search from
Return
Range
Element
— a search result indicating the next position of the search text, or null if there is no
    match
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Attributes()
Retrieves the element's attributes.
The result is an object containing a property for each valid element attribute where each
property name corresponds to an item in the
Document
App.Attribute
enumeration.
const
doc
=
DocumentApp
.
getActiveDocument
();
const
documentTab
=
doc
.
getActiveTab
().
asDocumentTab
();
const
body
=
documentTab
.
getBody
();
// Append a styled paragraph.
const
par
=
body
.
appendParagraph
(
'A bold, italicized paragraph.'
);
par
.
setBold
(
true
);
par
.
setItalic
(
true
);
// Retrieve the paragraph's attributes.
const
atts
=
par
.
getAttributes
();
// Log the paragraph attributes.
for
(
const
att
in
atts
)
{
Logger
.
log
(
`
${
att
}
:
${
atts
[
att
]
}
`
);
}
Return
Object
— The element's attributes.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Border
Color()
Retrieves the border color.
// Opens the Docs file by its ID. If you created your script from within a
// Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first table.
const
table
=
body
.
getTables
()[
0
];
// Sets the border color of the first table.
table
.
setBorderColor
(
'#00FF00'
);
// Logs the border color of the first table to the console.
console
.
log
(
table
.
getBorderColor
());
Return
String
— The border color, formatted in CSS notation (like
'#ffffff'
).
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Border
Width()
Retrieves the border width, in points.
// Opens the Docs file by its ID. If you created your script from within a
// Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first table.
const
table
=
body
.
getTables
()[
0
];
// Sets the border width of the first table.
table
.
setBorderWidth
(
20
);
// Logs the border width of the first table.
console
.
log
(
table
.
getBorderWidth
());
Return
Number
— The border width, in points.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Cell(rowIndex, cellIndex)
Retrieves the
Table
Cell
at the specified row and cell indices.
// Opens the Docs file by its ID. If you created your script from within a
// Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first table.
const
table
=
body
.
getTables
()[
0
];
// Gets the cell of the table's third row and second column.
const
cell
=
table
.
getCell
(
2
,
1
);
// Logs the cell text to the console.
console
.
log
(
cell
.
getText
());
Parameters
Name
Type
Description
row
Index
Integer
The index of the row containing the cell to retrieve.
cell
Index
Integer
The index of the cell to retrieve.
Return
Table
Cell
— The table cell.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Child(childIndex)
Retrieves the child element at the specified child index.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Obtain the first element in the tab.
const
firstChild
=
body
.
getChild
(
0
);
// If it's a paragraph, set its contents.
if
(
firstChild
.
getType
()
===
DocumentApp
.
ElementType
.
PARAGRAPH
)
{
firstChild
.
asParagraph
().
setText
(
'This is the first paragraph.'
);
}
Parameters
Name
Type
Description
child
Index
Integer
The index of the child element to retrieve.
Return
Element
— The child element at the specified index.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Child
Index(child)
Retrieves the child index for the specified child element.
Parameters
Name
Type
Description
child
Element
The child element for which to retrieve the index.
Return
Integer
— The child index.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Column
Width(columnIndex)
Retrieves the width of the specified table column, in points.
// Opens the Docs file by its ID. If you created your script from within a
// Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first table.
const
table
=
body
.
getTables
()[
0
];
// Sets the width of the second column to 100 points.
const
columnWidth
=
table
.
setColumnWidth
(
1
,
100
);
// Gets the width of the second column and logs it to the console.
console
.
log
(
columnWidth
.
getColumnWidth
(
1
));
Parameters
Name
Type
Description
column
Index
Integer
The column index.
Return
Number
— The column width, in points.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Link
Url()
Retrieves the link url.
Return
String
— the link url, or null if the element contains multiple values for this attribute
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Next
Sibling()
Retrieves the element's next sibling element.
The next sibling has the same parent and follows the current element.
Return
Element
— The next sibling element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Num
Children()
Retrieves the number of children.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Log the number of elements in the tab.
Logger
.
log
(
`There are
${
body
.
getNumChildren
()
}
elements in the tab's body.`
);
Return
Integer
— The number of children.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Num
Rows()
Retrieves the number of
Table
Rows
.
// Opens the Docs file by its ID. If you created your script from within a
// Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first table.
const
table
=
body
.
getTables
()[
0
];
// Logs the number of rows of the first table to the console.
console
.
log
(
table
.
getNumRows
());
Return
Integer
— The number of table rows.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Parent()
Retrieves the element's parent element.
The parent element contains the current element.
Return
Container
Element
— The parent element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Previous
Sibling()
Retrieves the element's previous sibling element.
The previous sibling has the same parent and precedes the current element.
Return
Element
— The previous sibling element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Row(rowIndex)
Retrieves the
Table
Row
at the specified row index.
// Opens the Docs file by its ID. If you created your script from within a
// Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first table and logs the text of first row to the console.
const
table
=
body
.
getTables
()[
0
];
console
.
log
(
table
.
getRow
(
0
).
getText
());
Parameters
Name
Type
Description
row
Index
Integer
The index of the row to retrieve.
Return
Table
Row
— The table row.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Text()
Retrieves the contents of the element as a text string.
Return
String
— the contents of the element as text string
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Text
Alignment()
Gets the text alignment. The available types of alignment are
Document
App.TextAlignment.NORMAL
,
Document
App.TextAlignment.SUBSCRIPT
, and
Document
App.TextAlignment.SUPERSCRIPT
.
Return
Text
Alignment
— the type of text alignment, or
null
if the text contains multiple types of text
    alignments or if the text alignment has never been set
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Type()
Retrieves the element's
Element
Type
.
Use
get
Type()
to determine the exact type of a given element.
const
doc
=
DocumentApp
.
getActiveDocument
();
const
documentTab
=
doc
.
getActiveTab
().
asDocumentTab
();
const
body
=
documentTab
.
getBody
();
// Obtain the first element in the active tab's body.
const
firstChild
=
body
.
getChild
(
0
);
// Use getType() to determine the element's type.
if
(
firstChild
.
getType
()
===
DocumentApp
.
ElementType
.
PARAGRAPH
)
{
Logger
.
log
(
'The first element is a paragraph.'
);
}
else
{
Logger
.
log
(
'The first element is not a paragraph.'
);
}
Return
Element
Type
— The element type.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
insert
Table
Row(childIndex)
Creates and inserts a new
Table
Row
at the specified index.
Parameters
Name
Type
Description
child
Index
Integer
the index at which to insert the element
Return
Table
Row
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
insert
Table
Row(childIndex, tableRow)
Inserts the given
Table
Row
at the specified index.
Parameters
Name
Type
Description
child
Index
Integer
the index at which to insert the element
table
Row
Table
Row
the table row to insert
Return
Table
Row
— the inserted table row element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
is
At
Document
End()
Determines whether the element is at the end of the
Document
.
Return
Boolean
— Whether the element is at the end of the tab.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
remove
Child(child)
Removes the specified child element.
// Opens the Docs file by its ID. If you created your script from within a
// Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first table.
const
table
=
body
.
getTables
()[
0
];
// Finds the first table row and removes it.
const
element
=
table
.
findElement
(
DocumentApp
.
ElementType
.
TABLE_ROW
);
table
.
removeChild
(
element
.
getElement
());
Parameters
Name
Type
Description
child
Element
The child element to remove.
Return
Table
— The current element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
remove
From
Parent()
Removes the element from its parent.
const
doc
=
DocumentApp
.
getActiveDocument
();
const
documentTab
=
doc
.
getActiveTab
().
asDocumentTab
();
const
body
=
documentTab
.
getBody
();
// Remove all images in the active tab's body.
const
imgs
=
body
.
getImages
();
for
(
let
i
=
0
;
i
<
imgs
.
length
;
i
++
)
{
imgs
[
i
].
removeFromParent
();
}
Return
Table
— The removed element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
remove
Row(rowIndex)
Removes the
Table
Row
at the specified row index.
// Opens the Docs file by its ID. If you created your script from within a
// Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first table and removes its second row.
const
table
=
body
.
getTables
()[
0
];
table
.
removeRow
(
1
);
Parameters
Name
Type
Description
row
Index
Integer
The index of the row to remove.
Return
Table
Row
— The removed row.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
replace
Text(searchPattern, replacement)
Replaces all occurrences of a given text pattern with a given replacement string, using regular
expressions.
The search pattern is passed as a string, not a JavaScript regular expression object.
Because of this you'll need to escape any backslashes in the pattern.
This methods uses Google's
RE2
regular
expression library, which limits the
supported syntax
.
The provided regular expression pattern is independently matched against each text block
contained in the current element.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Clear the text surrounding "Apps Script", with or without text.
body
.
replaceText
(
'^.*Apps ?Script.*$'
,
'Apps Script'
);
Parameters
Name
Type
Description
search
Pattern
String
the regex pattern to search for
replacement
String
the text to use as replacement
Return
Element
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Attributes(attributes)
Sets the element's attributes.
The specified attributes parameter must be an object where each property name is an item in
the
Document
App.Attribute
enumeration and each property value is the new value to be
applied.
const
doc
=
DocumentApp
.
getActiveDocument
();
const
documentTab
=
doc
.
getActiveTab
().
asDocumentTab
();
const
body
=
documentTab
.
getBody
();
// Define a custom paragraph style.
const
style
=
{};
style
[
DocumentApp
.
Attribute
.
HORIZONTAL_ALIGNMENT
]
=
DocumentApp
.
HorizontalAlignment
.
RIGHT
;
style
[
DocumentApp
.
Attribute
.
FONT_FAMILY
]
=
'Calibri'
;
style
[
DocumentApp
.
Attribute
.
FONT_SIZE
]
=
18
;
style
[
DocumentApp
.
Attribute
.
BOLD
]
=
true
;
// Append a plain paragraph.
const
par
=
body
.
appendParagraph
(
'A paragraph with custom style.'
);
// Apply the custom style.
par
.
setAttributes
(
style
);
Parameters
Name
Type
Description
attributes
Object
The element's attributes.
Return
Table
— The current element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Border
Color(color)
Sets the border color.
// Opens the Docs file by its ID. If you created your script from within a
// Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first table.
const
table
=
body
.
getTables
()[
0
];
// Sets the border color of the table to green.
table
.
setBorderColor
(
'#00FF00'
);
Parameters
Name
Type
Description
color
String
The border color, formatted in CSS notation (like
'#ffffff'
).
Return
Table
— The current element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Border
Width(width)
Sets the border width, in points.
Parameters
Name
Type
Description
width
Number
the border width, in points
Return
Table
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Column
Width(columnIndex, width)
Sets the width of the specified column, in points.
Parameters
Name
Type
Description
column
Index
Integer
the column index
width
Number
the border width, in points
Return
Table
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Link
Url(url)
Sets the link url.
Parameters
Name
Type
Description
url
String
the link url
Return
Table
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Text
Alignment(textAlignment)
Sets the text alignment. The available types of alignment are
Document
App.TextAlignment.NORMAL
,
Document
App.TextAlignment.SUBSCRIPT
, and
Document
App.TextAlignment.SUPERSCRIPT
.
// Make the entire first paragraph in the active tab be superscript.
const
documentTab
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
();
const
text
=
documentTab
.
getBody
().
getParagraphs
()[
0
].
editAsText
();
text
.
setTextAlignment
(
DocumentApp
.
TextAlignment
.
SUPERSCRIPT
);
Parameters
Name
Type
Description
text
Alignment
Text
Alignment
the type of text alignment to apply
Return
Table
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents