Source Path: gas_docs_html/apps-script/reference/document/paragraph/index.html

AI-generated Key Takeaways
outlined_flag
Several methods are available to manipulate elements within a Google Document using Apps Script, including replacing text, setting alignment, and adjusting spacing.
Methods like
replaceText
use regular expressions with limitations based on Google's RE2 library.
Various methods allow setting paragraph attributes, heading styles, indentations, and line spacing.
Authorization with specific scopes, such as
https://www.googleapis.com/auth/documents.currentonly
or
https://www.googleapis.com/auth/documents
, is required to use these methods.
You can set the entire text content of a paragraph using the
setText
method, which replaces existing content.
Paragraph
An element representing a paragraph. A
Paragraph
may contain
Equation
,
Footnote
,
Horizontal
Rule
,
Inline
Drawing
,
Inline
Image
,
Page
Break
,
and
Text
elements. For more information on document structure, see the
guide to extending Google Docs
.
Paragraphs
may not contain new-line characters. New-line characters ("\n") are
converted to line-break characters ("\r").
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Append a tab header paragraph.
const
header
=
body
.
appendParagraph
(
'A Document'
);
header
.
setHeading
(
DocumentApp
.
ParagraphHeading
.
HEADING1
);
// Append a section header paragraph.
const
section
=
body
.
appendParagraph
(
'Section 1'
);
section
.
setHeading
(
DocumentApp
.
ParagraphHeading
.
HEADING2
);
// Append a regular paragraph.
body
.
appendParagraph
(
'This is a typical paragraph.'
);
Methods
Method
Return type
Brief description
add
Positioned
Image(image)
Positioned
Image
Creates and inserts a new
Positioned
Image
from the specified image blob.
append
Horizontal
Rule()
Horizontal
Rule
Creates and appends a new
Horizontal
Rule
.
append
Inline
Image(image)
Inline
Image
Creates and appends a new
Inline
Image
from the specified image blob.
append
Inline
Image(image)
Inline
Image
Appends the given
Inline
Image
.
append
Page
Break()
Page
Break
Creates and appends a new
Page
Break
.
append
Page
Break(pageBreak)
Page
Break
Appends the given
Page
Break
.
append
Text(text)
Text
Creates and appends a new
Text
element with the specified contents.
append
Text(text)
Text
Appends the given
Text
element.
clear()
Paragraph
Clears the contents of the element.
copy()
Paragraph
Returns a detached, deep copy of the current element.
edit
As
Text()
Text
Obtains a
Text
version of the current element, for editing.
find
Element(elementType)
Range
Element
Searches the contents of the element for a descendant of the specified type.
find
Element(elementType, from)
Range
Element
Searches the contents of the element for a descendant of the specified type, starting from the
specified
Range
Element
.
find
Text(searchPattern)
Range
Element
Searches the contents of the element for the specified text pattern using regular expressions.
find
Text(searchPattern, from)
Range
Element
Searches the contents of the element for the specified text pattern, starting from a given
search result.
get
Alignment()
Horizontal
Alignment
Retrieves the
Horizontal
Alignment
.
get
Attributes()
Object
Retrieves the element's attributes.
get
Child(childIndex)
Element
Retrieves the child element at the specified child index.
get
Child
Index(child)
Integer
Retrieves the child index for the specified child element.
get
Heading()
Paragraph
Heading
Retrieves the
Paragraph
Heading
.
get
Indent
End()
Number
Retrieves the end indentation, in points.
get
Indent
First
Line()
Number
Retrieves the first line indentation, in points.
get
Indent
Start()
Number
Retrieves the start indentation.
get
Line
Spacing()
Number
Retrieves the line spacing, in points.
get
Link
Url()
String
Retrieves the link url.
get
Next
Sibling()
Element
Retrieves the element's next sibling element.
get
Num
Children()
Integer
Retrieves the number of children.
get
Parent()
Container
Element
Retrieves the element's parent element.
get
Positioned
Image(id)
Positioned
Image
Gets a
Positioned
Image
by the image's ID.
get
Positioned
Images()
Positioned
Image[]
Gets all
Positioned
Image
objects anchored to the paragraph.
get
Previous
Sibling()
Element
Retrieves the element's previous sibling element.
get
Spacing
After()
Number
Retrieves the spacing after the element, in points.
get
Spacing
Before()
Number
Retrieves the spacing before the element, in points.
get
Text()
String
Retrieves the contents of the element as a text string.
get
Text
Alignment()
Text
Alignment
Gets the text alignment.
get
Type()
Element
Type
Retrieves the element's
Element
Type
.
insert
Horizontal
Rule(childIndex)
Horizontal
Rule
Creates and inserts a
Horizontal
Rule
at the specified index.
insert
Inline
Image(childIndex, image)
Inline
Image
Creates and inserts a new
Inline
Image
from the specified image blob, at the specified
index.
insert
Inline
Image(childIndex, image)
Inline
Image
Inserts the given
Inline
Image
at the specified index.
insert
Page
Break(childIndex)
Page
Break
Creates and inserts a new
Page
Break
at the specified index.
insert
Page
Break(childIndex, pageBreak)
Page
Break
Inserts the given
Page
Break
at the specified index.
insert
Text(childIndex, text)
Text
Creates and inserts a new text element at the specified index.
insert
Text(childIndex, text)
Text
Inserts the given
Text
element at the specified index, with the specified text
contents.
is
At
Document
End()
Boolean
Determines whether the element is at the end of the
Document
.
is
Left
To
Right()
Boolean
Retrieves the left-to-right setting.
merge()
Paragraph
Merges the element with the preceding sibling of the same type.
remove
Child(child)
Paragraph
Removes the specified child element.
remove
From
Parent()
Paragraph
Removes the element from its parent.
remove
Positioned
Image(id)
Boolean
Removes a
Positioned
Image
by the image's ID.
replace
Text(searchPattern, replacement)
Element
Replaces all occurrences of a given text pattern with a given replacement string, using regular
expressions.
set
Alignment(alignment)
Paragraph
Sets the
Horizontal
Alignment
.
set
Attributes(attributes)
Paragraph
Sets the element's attributes.
set
Heading(heading)
Paragraph
Sets the
Paragraph
Heading
.
set
Indent
End(indentEnd)
Paragraph
Sets the end indentation, in points.
set
Indent
First
Line(indentFirstLine)
Paragraph
Sets the first line indentation, in points.
set
Indent
Start(indentStart)
Paragraph
Sets the start indentation, in points.
set
Left
To
Right(leftToRight)
Paragraph
Sets the left-to-right setting.
set
Line
Spacing(multiplier)
Paragraph
Sets the line spacing, as a quantity indicating the number of lines to use for spacing.
set
Link
Url(url)
Paragraph
Sets the link url.
set
Spacing
After(spacingAfter)
Paragraph
Sets the spacing after the element, in points.
set
Spacing
Before(spacingBefore)
Paragraph
Sets the spacing before the element, in points.
set
Text(text)
void
Sets the contents of the paragraph as text.
set
Text
Alignment(textAlignment)
Paragraph
Sets the text alignment.
Detailed documentation
add
Positioned
Image(image)
Creates and inserts a new
Positioned
Image
from the specified image blob.
// Opens the Docs file by its ID. If you created your script from within
// a Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first paragraph from the body.
const
paragraph
=
body
.
getParagraphs
()[
0
];
// Fetches the specified image URL.
const
image
=
UrlFetchApp
.
fetch
(
'https://fonts.gstatic.com/s/i/productlogos/apps_script/v10/web-24dp/logo_apps_script_color_1x_web_24dp.png'
,
);
// Adds the image to the tab, anchored to the first paragraph.
paragraph
.
addPositionedImage
(
image
);
Parameters
Name
Type
Description
image
Blob
Source
The image data.
Return
Positioned
Image
— The new positioned image.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
append
Horizontal
Rule()
Creates and appends a new
Horizontal
Rule
.
// Opens the Docs file by its ID. If you created your script from within
// a Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first paragraph from the body.
const
paragraph
=
body
.
getParagraphs
()[
0
];
// Adds a horizontal line under the first paragraph.
paragraph
.
appendHorizontalRule
();
Return
Horizontal
Rule
— The new horizontal rule.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
append
Inline
Image(image)
Creates and appends a new
Inline
Image
from the specified image blob.
// Opens the Docs file by its ID. If you created your script from within
// a Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first paragraph from the body.
const
paragraph
=
body
.
getParagraphs
()[
0
];
// Fetches the image from the specified image URL.
const
image
=
UrlFetchApp
.
fetch
(
'https://fonts.gstatic.com/s/i/productlogos/apps_script/v10/web-96dp/logo_apps_script_color_1x_web_96dp.png'
,
);
// Adds the image to the first paragraph.
paragraph
.
appendInlineImage
(
image
);
Parameters
Name
Type
Description
image
Blob
Source
The image data.
Return
Inline
Image
— The appended image.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
append
Inline
Image(image)
Appends the given
Inline
Image
.
// Opens the Docs file by its ID. If you created your script from within
// a Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first paragraph from the body.
const
paragraph
=
body
.
getParagraphs
()[
0
];
// Makes a copy of the first image in the body.
const
image
=
body
.
getImages
()[
0
].
copy
();
// Adds the image to the first paragraph.
paragraph
.
appendInlineImage
(
image
);
Parameters
Name
Type
Description
image
Inline
Image
The image data.
Return
Inline
Image
— The appended image.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
append
Page
Break()
Creates and appends a new
Page
Break
.
Note:
Page
Breaks
may not be contained within
Table
Cells
.
If the current element is contained in a table cell, an exception will be thrown.
// Opens the Docs file by its ID. If you created your script from within
// a Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first paragraph from the body.
const
paragraph
=
body
.
getParagraphs
()[
0
];
// Adds a page break after the first paragraph.
paragraph
.
appendPageBreak
();
Return
Page
Break
— The new page break element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
append
Page
Break(pageBreak)
Appends the given
Page
Break
.
Note:
Page
Breaks
can't be contained within
Table
Cells
.
If the current element exists in a table cell, the script throws an exception.
// Opens the Docs file by its ID. If you created your script from within
// a Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first paragraph from the body.
const
paragraph
=
body
.
getParagraphs
()[
0
];
// Adds a page break after the first paragraph.
const
pageBreak
=
paragraph
.
appendPageBreak
();
// Makes a copy of the page break.
const
newPageBreak
=
pageBreak
.
copy
();
// Adds the copied page break to the paragraph.
paragraph
.
appendPageBreak
(
newPageBreak
);
Parameters
Name
Type
Description
page
Break
Page
Break
The page break to append.
Return
Page
Break
— The appended page break element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
append
Text(text)
Creates and appends a new
Text
element with the specified contents.
// Opens the Docs file by its ID. If you created your script from within
// a Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first paragraph from the body.
const
paragraph
=
body
.
getParagraphs
()[
0
];
// Adds a string to the paragraph.
paragraph
.
appendText
(
'This is a new sentence.'
);
Parameters
Name
Type
Description
text
String
The text contents.
Return
Text
— The new text element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
append
Text(text)
Appends the given
Text
element.
// Opens the Docs file by its ID. If you created your script from within
// a Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the text from the first paragraph in the body.
const
paragraph1
=
body
.
getParagraphs
()[
0
];
const
text
=
paragraph1
.
getText
();
// Gets the third paragraph in the body.
const
paragraph3
=
body
.
getParagraphs
()[
2
];
// Adds the text from the first paragraph to the third paragraph.
paragraph3
.
appendText
(
text
);
Parameters
Name
Type
Description
text
Text
The text element to append.
Return
Text
— The appended text element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
clear()
Clears the contents of the element.
Return
Paragraph
— The current element.
copy()
Returns a detached, deep copy of the current element.
Any child elements present in the element are also copied. The new element doesn't have a
parent.
Return
Paragraph
— The new copy.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
edit
As
Text()
Obtains a
Text
version of the current element, for editing.
Use
edit
As
Text
for manipulating the elements contents as rich text. The
edit
As
Text
mode ignores non-text elements (such as
Inline
Image
and
Horizontal
Rule
).
Child elements fully contained within a deleted text range are removed from the element.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Insert two paragraphs separated by a paragraph containing an
// horizontal rule.
body
.
insertParagraph
(
0
,
'An editAsText sample.'
);
body
.
insertHorizontalRule
(
0
);
body
.
insertParagraph
(
0
,
'An example.'
);
// Delete " sample.\n\n An" removing the horizontal rule in the process.
body
.
editAsText
().
deleteText
(
14
,
25
);
Return
Text
— a text version of the current element
find
Element(elementType)
Searches the contents of the element for a descendant of the specified type.
Parameters
Name
Type
Description
element
Type
Element
Type
The type of element to search for.
Return
Range
Element
— A search result indicating the position of the search element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
find
Element(elementType, from)
Searches the contents of the element for a descendant of the specified type, starting from the
specified
Range
Element
.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Define the search parameters.
let
searchResult
=
null
;
// Search until the paragraph is found.
while
(
(
searchResult
=
body
.
findElement
(
DocumentApp
.
ElementType
.
PARAGRAPH
,
searchResult
,
)))
{
const
par
=
searchResult
.
getElement
().
asParagraph
();
if
(
par
.
getHeading
()
===
DocumentApp
.
ParagraphHeading
.
HEADING1
)
{
// Found one, update and stop.
par
.
setText
(
'This is the first header.'
);
break
;
}
}
Parameters
Name
Type
Description
element
Type
Element
Type
The type of element to search for.
from
Range
Element
The search result to search from.
Return
Range
Element
— A search result indicating the next position of the search element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
find
Text(searchPattern)
Searches the contents of the element for the specified text pattern using regular expressions.
A subset of the JavaScript regular expression features are not fully supported, such as
capture groups and mode modifiers.
The provided regular expression pattern is independently matched against each text block
contained in the current element.
Parameters
Name
Type
Description
search
Pattern
String
the pattern to search for
Return
Range
Element
— a search result indicating the position of the search text, or null if there is no
    match
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
find
Text(searchPattern, from)
Searches the contents of the element for the specified text pattern, starting from a given
search result.
A subset of the JavaScript regular expression features are not fully supported, such as
capture groups and mode modifiers.
The provided regular expression pattern is independently matched against each text block
contained in the current element.
Parameters
Name
Type
Description
search
Pattern
String
the pattern to search for
from
Range
Element
the search result to search from
Return
Range
Element
— a search result indicating the next position of the search text, or null if there is no
    match
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Alignment()
Retrieves the
Horizontal
Alignment
.
// Opens the Docs file by its ID. If you created your script from within
// a Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Gets the first paragraph from the body.
const
paragraph
=
body
.
getParagraphs
()[
0
];
// Sets the horizontal alignment to left for the first paragraph.
paragraph
.
setAlignment
(
DocumentApp
.
HorizontalAlignment
.
LEFT
);
// Gets the horizontal alignment of the first paragraph and logs it to the
// console.
console
.
log
(
paragraph
.
getAlignment
().
toString
());
Return
Horizontal
Alignment
— The alignment.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Attributes()
Retrieves the element's attributes.
The result is an object containing a property for each valid element attribute where each
property name corresponds to an item in the
Document
App.Attribute
enumeration.
const
doc
=
DocumentApp
.
getActiveDocument
();
const
documentTab
=
doc
.
getActiveTab
().
asDocumentTab
();
const
body
=
documentTab
.
getBody
();
// Append a styled paragraph.
const
par
=
body
.
appendParagraph
(
'A bold, italicized paragraph.'
);
par
.
setBold
(
true
);
par
.
setItalic
(
true
);
// Retrieve the paragraph's attributes.
const
atts
=
par
.
getAttributes
();
// Log the paragraph attributes.
for
(
const
att
in
atts
)
{
Logger
.
log
(
`
${
att
}
:
${
atts
[
att
]
}
`
);
}
Return
Object
— The element's attributes.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Child(childIndex)
Retrieves the child element at the specified child index.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Obtain the first element in the tab.
const
firstChild
=
body
.
getChild
(
0
);
// If it's a paragraph, set its contents.
if
(
firstChild
.
getType
()
===
DocumentApp
.
ElementType
.
PARAGRAPH
)
{
firstChild
.
asParagraph
().
setText
(
'This is the first paragraph.'
);
}
Parameters
Name
Type
Description
child
Index
Integer
The index of the child element to retrieve.
Return
Element
— The child element at the specified index.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Child
Index(child)
Retrieves the child index for the specified child element.
Parameters
Name
Type
Description
child
Element
The child element for which to retrieve the index.
Return
Integer
— The child index.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Heading()
Retrieves the
Paragraph
Heading
.
// Opens the Docs file by its ID. If you created your script from within
// a Google Docs file, you can use DocumentApp.getActiveDocument() instead.
// TODO(developer): Replace the ID with your own.
const
doc
=
DocumentApp
.
openById
(
'123abc'
);
// Gets the body contents of the tab by its ID.
// TODO(developer): Replace the ID with your own.
const
body
=
doc
.
getTab
(
'123abc'
).
asDocumentTab
().
getBody
();
// Adds a paragraph to the body.
const
paragraph
=
body
.
appendParagraph
(
'Title heading'
);
// Sets the paragraph heading style to 'Title.'
paragraph
.
setHeading
(
DocumentApp
.
ParagraphHeading
.
TITLE
);
// Gets the heading style and logs it to the console.
console
.
log
(
paragraph
.
getHeading
().
toString
());
Return
Paragraph
Heading
— The heading.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Indent
End()
Retrieves the end indentation, in points.
Return
Number
— the end indentation, in points
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Indent
First
Line()
Retrieves the first line indentation, in points.
Return
Number
— the first line indentation, in points
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Indent
Start()
Retrieves the start indentation.
Return
Number
— the start indentation
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Line
Spacing()
Retrieves the line spacing, in points.
Return
Number
— the line spacing, in points
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Link
Url()
Retrieves the link url.
Return
String
— the link url, or null if the element contains multiple values for this attribute
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Next
Sibling()
Retrieves the element's next sibling element.
The next sibling has the same parent and follows the current element.
Return
Element
— The next sibling element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Num
Children()
Retrieves the number of children.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Log the number of elements in the tab.
Logger
.
log
(
`There are
${
body
.
getNumChildren
()
}
elements in the tab's body.`
);
Return
Integer
— The number of children.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Parent()
Retrieves the element's parent element.
The parent element contains the current element.
Return
Container
Element
— The parent element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Positioned
Image(id)
Gets a
Positioned
Image
by the image's ID.
Parameters
Name
Type
Description
id
String
the image id
Return
Positioned
Image
— the positioned image
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Positioned
Images()
Gets all
Positioned
Image
objects anchored to the paragraph.
Return
Positioned
Image[]
— a list of positioned images
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Previous
Sibling()
Retrieves the element's previous sibling element.
The previous sibling has the same parent and precedes the current element.
Return
Element
— The previous sibling element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Spacing
After()
Retrieves the spacing after the element, in points.
Return
Number
— the spacing after the element, in points
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Spacing
Before()
Retrieves the spacing before the element, in points.
Return
Number
— the spacing before the element, in points
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Text()
Retrieves the contents of the element as a text string.
Return
String
— the contents of the element as text string
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Text
Alignment()
Gets the text alignment. The available types of alignment are
Document
App.TextAlignment.NORMAL
,
Document
App.TextAlignment.SUBSCRIPT
, and
Document
App.TextAlignment.SUPERSCRIPT
.
Return
Text
Alignment
— the type of text alignment, or
null
if the text contains multiple types of text
    alignments or if the text alignment has never been set
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
get
Type()
Retrieves the element's
Element
Type
.
Use
get
Type()
to determine the exact type of a given element.
const
doc
=
DocumentApp
.
getActiveDocument
();
const
documentTab
=
doc
.
getActiveTab
().
asDocumentTab
();
const
body
=
documentTab
.
getBody
();
// Obtain the first element in the active tab's body.
const
firstChild
=
body
.
getChild
(
0
);
// Use getType() to determine the element's type.
if
(
firstChild
.
getType
()
===
DocumentApp
.
ElementType
.
PARAGRAPH
)
{
Logger
.
log
(
'The first element is a paragraph.'
);
}
else
{
Logger
.
log
(
'The first element is not a paragraph.'
);
}
Return
Element
Type
— The element type.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
insert
Horizontal
Rule(childIndex)
Creates and inserts a
Horizontal
Rule
at the specified index.
Parameters
Name
Type
Description
child
Index
Integer
the index at which to insert the element
Return
Horizontal
Rule
— the new horizontal rule element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
insert
Inline
Image(childIndex, image)
Creates and inserts a new
Inline
Image
from the specified image blob, at the specified
index.
Parameters
Name
Type
Description
child
Index
Integer
the index at which to insert the element
image
Blob
Source
the image data
Return
Inline
Image
— the inserted inline image element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
insert
Inline
Image(childIndex, image)
Inserts the given
Inline
Image
at the specified index.
Parameters
Name
Type
Description
child
Index
Integer
the index at which to insert the element
image
Inline
Image
the image data
Return
Inline
Image
— the inserted inline image element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
insert
Page
Break(childIndex)
Creates and inserts a new
Page
Break
at the specified index.
Note:
Page
Breaks
may not be contained within
Table
Cells
.
If the current element is contained in a table cell, an exception will be thrown.
Parameters
Name
Type
Description
child
Index
Integer
the index at which to insert the element
Return
Page
Break
— the new page break element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
insert
Page
Break(childIndex, pageBreak)
Inserts the given
Page
Break
at the specified index.
Note:
Page
Breaks
may not be contained within
Table
Cells
.
If the current element is contained in a table cell, an exception will be thrown.
Parameters
Name
Type
Description
child
Index
Integer
the index at which to insert the element
page
Break
Page
Break
the p[age break to insert
Return
Page
Break
— the inserted page break element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
insert
Text(childIndex, text)
Creates and inserts a new text element at the specified index.
Parameters
Name
Type
Description
child
Index
Integer
the index at which to insert the element
text
String
the text contents
Return
Text
— the new text element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
insert
Text(childIndex, text)
Inserts the given
Text
element at the specified index, with the specified text
contents.
Parameters
Name
Type
Description
child
Index
Integer
the index at which to insert the element
text
Text
the text element to insert
Return
Text
— the inserted text element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
is
At
Document
End()
Determines whether the element is at the end of the
Document
.
Return
Boolean
— Whether the element is at the end of the tab.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
is
Left
To
Right()
Retrieves the left-to-right setting.
Return
Boolean
— the left-to-right setting
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
merge()
Merges the element with the preceding sibling of the same type.
Only elements of the same
Element
Type
can be merged. Any child elements contained in
the current element are moved to the preceding sibling element.
The current element is removed from the document.
const
doc
=
DocumentApp
.
getActiveDocument
();
const
documentTab
=
doc
.
getActiveTab
().
asDocumentTab
();
const
body
=
documentTab
.
getBody
();
// Example 1: Merge paragraphs
// Append two paragraphs to the document's active tab.
const
par1
=
body
.
appendParagraph
(
'Paragraph 1.'
);
const
par2
=
body
.
appendParagraph
(
'Paragraph 2.'
);
// Merge the newly added paragraphs into a single paragraph.
par2
.
merge
();
// Example 2: Merge table cells
// Create a two-dimensional array containing the table's cell contents.
const
cells
=
[
[
'Row 1, Cell 1'
,
'Row 1, Cell 2'
],
[
'Row 2, Cell 1'
,
'Row 2, Cell 2'
],
];
// Build a table from the array.
const
table
=
body
.
appendTable
(
cells
);
// Get the first row in the table.
const
row
=
table
.
getRow
(
0
);
// Get the two cells in this row.
const
cell1
=
row
.
getCell
(
0
);
const
cell2
=
row
.
getCell
(
1
);
// Merge the current cell into its preceding sibling element.
const
merged
=
cell2
.
merge
();
Return
Paragraph
— The merged element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
remove
Child(child)
Removes the specified child element.
Parameters
Name
Type
Description
child
Element
the child element to remove
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
remove
From
Parent()
Removes the element from its parent.
const
doc
=
DocumentApp
.
getActiveDocument
();
const
documentTab
=
doc
.
getActiveTab
().
asDocumentTab
();
const
body
=
documentTab
.
getBody
();
// Remove all images in the active tab's body.
const
imgs
=
body
.
getImages
();
for
(
let
i
=
0
;
i
<
imgs
.
length
;
i
++
)
{
imgs
[
i
].
removeFromParent
();
}
Return
Paragraph
— The removed element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
remove
Positioned
Image(id)
Removes a
Positioned
Image
by the image's ID.
Parameters
Name
Type
Description
id
String
the image id
Return
Boolean
— whether or not the specified image was removed
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
replace
Text(searchPattern, replacement)
Replaces all occurrences of a given text pattern with a given replacement string, using regular
expressions.
The search pattern is passed as a string, not a JavaScript regular expression object.
Because of this you'll need to escape any backslashes in the pattern.
This methods uses Google's
RE2
regular
expression library, which limits the
supported syntax
.
The provided regular expression pattern is independently matched against each text block
contained in the current element.
const
body
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
().
getBody
();
// Clear the text surrounding "Apps Script", with or without text.
body
.
replaceText
(
'^.*Apps ?Script.*$'
,
'Apps Script'
);
Parameters
Name
Type
Description
search
Pattern
String
the regex pattern to search for
replacement
String
the text to use as replacement
Return
Element
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Alignment(alignment)
Sets the
Horizontal
Alignment
.
Parameters
Name
Type
Description
alignment
Horizontal
Alignment
the horizontal alignment
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Attributes(attributes)
Sets the element's attributes.
The specified attributes parameter must be an object where each property name is an item in
the
Document
App.Attribute
enumeration and each property value is the new value to be
applied.
const
doc
=
DocumentApp
.
getActiveDocument
();
const
documentTab
=
doc
.
getActiveTab
().
asDocumentTab
();
const
body
=
documentTab
.
getBody
();
// Define a custom paragraph style.
const
style
=
{};
style
[
DocumentApp
.
Attribute
.
HORIZONTAL_ALIGNMENT
]
=
DocumentApp
.
HorizontalAlignment
.
RIGHT
;
style
[
DocumentApp
.
Attribute
.
FONT_FAMILY
]
=
'Calibri'
;
style
[
DocumentApp
.
Attribute
.
FONT_SIZE
]
=
18
;
style
[
DocumentApp
.
Attribute
.
BOLD
]
=
true
;
// Append a plain paragraph.
const
par
=
body
.
appendParagraph
(
'A paragraph with custom style.'
);
// Apply the custom style.
par
.
setAttributes
(
style
);
Parameters
Name
Type
Description
attributes
Object
The element's attributes.
Return
Paragraph
— The current element.
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Heading(heading)
Sets the
Paragraph
Heading
.
Parameters
Name
Type
Description
heading
Paragraph
Heading
the heading
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Indent
End(indentEnd)
Sets the end indentation, in points.
Parameters
Name
Type
Description
indent
End
Number
the end indentation, in points
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Indent
First
Line(indentFirstLine)
Sets the first line indentation, in points.
Parameters
Name
Type
Description
indent
First
Line
Number
the first line indentation, in points
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Indent
Start(indentStart)
Sets the start indentation, in points.
Parameters
Name
Type
Description
indent
Start
Number
the start indentation, in points
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Left
To
Right(leftToRight)
Sets the left-to-right setting.
Parameters
Name
Type
Description
left
To
Right
Boolean
the left-to-right setting
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Line
Spacing(multiplier)
Sets the line spacing, as a quantity indicating the number of lines to use for spacing.
Parameters
Name
Type
Description
multiplier
Number
the number of lines
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Link
Url(url)
Sets the link url.
Parameters
Name
Type
Description
url
String
the link url
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Spacing
After(spacingAfter)
Sets the spacing after the element, in points.
Parameters
Name
Type
Description
spacing
After
Number
the spacing after the element, in points
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Spacing
Before(spacingBefore)
Sets the spacing before the element, in points.
Parameters
Name
Type
Description
spacing
Before
Number
the spacing before the element, in points
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Text(text)
Sets the contents of the paragraph as text.
Note: existing contents are cleared.
Parameters
Name
Type
Description
text
String
the new text contents
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents
set
Text
Alignment(textAlignment)
Sets the text alignment. The available types of alignment are
Document
App.TextAlignment.NORMAL
,
Document
App.TextAlignment.SUBSCRIPT
, and
Document
App.TextAlignment.SUPERSCRIPT
.
// Make the entire first paragraph in the active tab be superscript.
const
documentTab
=
DocumentApp
.
getActiveDocument
().
getActiveTab
().
asDocumentTab
();
const
text
=
documentTab
.
getBody
().
getParagraphs
()[
0
].
editAsText
();
text
.
setTextAlignment
(
DocumentApp
.
TextAlignment
.
SUPERSCRIPT
);
Parameters
Name
Type
Description
text
Alignment
Text
Alignment
the type of text alignment to apply
Return
Paragraph
— the current element
Authorization
Scripts that use this method require authorization with one or more of the following
scopes
:
https://www.googleapis.com/auth/documents.currentonly
https://www.googleapis.com/auth/documents