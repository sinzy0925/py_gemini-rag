Source Path: gas_docs_html/apps-script/reference/spreadsheet/embedded-table-chart-builder/index.html

AI-generated Key Takeaways
outlined_flag
EmbeddedTableChartBuilder is a builder specifically for table charts, offering various methods to configure their appearance and behavior.
You can add or remove data ranges, set the chart type to other embedded chart types, and build the chart with the
build()
method.
Key table-specific options include enabling paging and sorting, setting the first row number, enabling right-to-left support, showing row numbers, and using alternating row styles.
Additional methods allow setting advanced chart options, the position of the chart on the sheet, the merge strategy for multiple ranges, and the strategy for hidden dimensions.
You can also retrieve information about the chart's current type, container, and data ranges.
Embedded
Table
Chart
Builder
Builder for table charts. For more details, see the Gviz
documentation
.
Methods
Method
Return type
Brief description
add
Range(range)
Embedded
Chart
Builder
Adds a range to the chart this builder modifies.
as
Area
Chart()
Embedded
Area
Chart
Builder
Sets the chart type to AreaChart and returns an
Embedded
Area
Chart
Builder
.
as
Bar
Chart()
Embedded
Bar
Chart
Builder
Sets the chart type to BarChart and returns an
Embedded
Bar
Chart
Builder
.
as
Column
Chart()
Embedded
Column
Chart
Builder
Sets the chart type to ColumnChart and returns an
Embedded
Column
Chart
Builder
.
as
Combo
Chart()
Embedded
Combo
Chart
Builder
Sets the chart type to ComboChart and returns an
Embedded
Combo
Chart
Builder
.
as
Histogram
Chart()
Embedded
Histogram
Chart
Builder
Sets the chart type to HistogramChart and returns an
Embedded
Histogram
Chart
Builder
.
as
Line
Chart()
Embedded
Line
Chart
Builder
Sets the chart type to LineChart and returns an
Embedded
Line
Chart
Builder
.
as
Pie
Chart()
Embedded
Pie
Chart
Builder
Sets the chart type to PieChart and returns an
Embedded
Pie
Chart
Builder
.
as
Scatter
Chart()
Embedded
Scatter
Chart
Builder
Sets the chart type to ScatterChart and returns an
Embedded
Scatter
Chart
Builder
.
as
Table
Chart()
Embedded
Table
Chart
Builder
Sets the chart type to TableChart and returns an
Embedded
Table
Chart
Builder
.
build()
Embedded
Chart
Builds the chart to reflect all changes made to it.
clear
Ranges()
Embedded
Chart
Builder
Removes all ranges from the chart this builder modifies.
enable
Paging(enablePaging)
Embedded
Table
Chart
Builder
Sets whether to enable paging through the data.
enable
Paging(pageSize)
Embedded
Table
Chart
Builder
Enables paging and sets the number of rows in each page.
enable
Paging(pageSize, startPage)
Embedded
Table
Chart
Builder
Enables paging, sets the number of rows in each page and the first table page to display (page
numbers are zero based).
enable
Rtl
Table(rtlEnabled)
Embedded
Table
Chart
Builder
Adds basic support for right-to-left languages (such as Arabic or Hebrew) by reversing the
column order of the table, so that column zero is the right-most column, and the last column is
the left-most column.
enable
Sorting(enableSorting)
Embedded
Table
Chart
Builder
Sets whether to sort columns when the user clicks a column heading.
get
Chart
Type()
Chart
Type
Returns the current chart type.
get
Container()
Container
Info
Return the chart
Container
Info
, which encapsulates where the chart appears on the
sheet.
get
Ranges()
Range[]
Returns a copy of the list of ranges currently providing data for this chart.
remove
Range(range)
Embedded
Chart
Builder
Removes the specified range from the chart this builder modifies.
set
Chart
Type(type)
Embedded
Chart
Builder
Changes the type of chart.
set
First
Row
Number(number)
Embedded
Table
Chart
Builder
Sets the row number for the first row in the data table.
set
Hidden
Dimension
Strategy(strategy)
Embedded
Chart
Builder
Sets the strategy to use for hidden rows and columns.
set
Initial
Sorting
Ascending(column)
Embedded
Table
Chart
Builder
Sets the index of the column according to which the table should be initially sorted
(ascending).
set
Initial
Sorting
Descending(column)
Embedded
Table
Chart
Builder
Sets the index of the column according to which the table should be initially sorted
(descending).
set
Merge
Strategy(mergeStrategy)
Embedded
Chart
Builder
Sets the merge strategy to use when more than one range exists.
set
Num
Headers(headers)
Embedded
Chart
Builder
Sets the number of rows or columns of the range that should be treated as headers.
set
Option(option, value)
Embedded
Chart
Builder
Sets advanced options for this chart.
set
Position(anchorRowPos, anchorColPos, offsetX, offsetY)
Embedded
Chart
Builder
Sets the position, changing where the chart appears on the sheet.
set
Transpose
Rows
And
Columns(transpose)
Embedded
Chart
Builder
Sets whether the chart's rows and columns are transposed.
show
Row
Number
Column(showRowNumber)
Embedded
Table
Chart
Builder
Sets whether to show the row number as the first column of the table.
use
Alternating
Row
Style(alternate)
Embedded
Table
Chart
Builder
Sets whether alternating color style is assigned to odd and even rows of a table chart.
Detailed documentation
add
Range(range)
Adds a range to the chart this builder modifies. Does not add the range if it has already been
added to the chart.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
chart
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
sheet
.
getRange
(
'A1:B8'
))
.
setPosition
(
5
,
5
,
0
,
0
)
.
build
();
sheet
.
insertChart
(
chart
);
Parameters
Name
Type
Description
range
Range
The range to add.
Return
Embedded
Chart
Builder
— This builder, for chaining.
as
Area
Chart()
Sets the chart type to AreaChart and returns an
Embedded
Area
Chart
Builder
.
Return
Embedded
Area
Chart
Builder
— A builder for an area chart.
as
Bar
Chart()
Sets the chart type to BarChart and returns an
Embedded
Bar
Chart
Builder
.
Return
Embedded
Bar
Chart
Builder
— A builder for a bar chart.
as
Column
Chart()
Sets the chart type to ColumnChart and returns an
Embedded
Column
Chart
Builder
.
Return
Embedded
Column
Chart
Builder
— A builder for a column chart.
as
Combo
Chart()
Sets the chart type to ComboChart and returns an
Embedded
Combo
Chart
Builder
.
Return
Embedded
Combo
Chart
Builder
— A builder for a combo chart.
as
Histogram
Chart()
Sets the chart type to HistogramChart and returns an
Embedded
Histogram
Chart
Builder
.
Return
Embedded
Histogram
Chart
Builder
— A builder for a histogram chart.
as
Line
Chart()
Sets the chart type to LineChart and returns an
Embedded
Line
Chart
Builder
.
Return
Embedded
Line
Chart
Builder
— A builder for a line chart.
as
Pie
Chart()
Sets the chart type to PieChart and returns an
Embedded
Pie
Chart
Builder
.
Return
Embedded
Pie
Chart
Builder
— A builder for a pie chart.
as
Scatter
Chart()
Sets the chart type to ScatterChart and returns an
Embedded
Scatter
Chart
Builder
.
Return
Embedded
Scatter
Chart
Builder
— A builder for a scatter chart.
as
Table
Chart()
Sets the chart type to TableChart and returns an
Embedded
Table
Chart
Builder
.
Return
Embedded
Table
Chart
Builder
— A builder for a table chart.
build()
Builds the chart to reflect all changes made to it.
This method does not automatically draw the chart on top of the spreadsheet. A new chart
must be inserted via
sheet.insertChart(chart)
, and an existing chart should be updated
via
sheet.updateChart(chart)
.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
range
=
sheet
.
getRange
(
'A1:B5'
);
const
chart
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
range
)
.
setPosition
(
5
,
5
,
0
,
0
)
.
build
();
sheet
.
insertChart
(
chart
);
Return
Embedded
Chart
— The created chart, which must still be added to the spreadsheet.
clear
Ranges()
Removes all ranges from the chart this builder modifies.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
// This code updates the chart to use only the new ranges while preserving the
// existing formatting of the chart.
const
chart
=
sheet
.
getCharts
()[
0
];
const
newChart
=
chart
.
modify
()
.
clearRanges
()
.
addRange
(
sheet
.
getRange
(
'A1:A5'
))
.
addRange
(
sheet
.
getRange
(
'B1:B5'
))
.
build
();
sheet
.
updateChart
(
newChart
);
Return
Embedded
Chart
Builder
— This builder, for chaining.
enable
Paging(enablePaging)
Sets whether to enable paging through the data.
The default behavior is paging disabled. If paging is enabled the default page size is 10.
Parameters
Name
Type
Description
enable
Paging
Boolean
true
if paging should be enabled,
false
otherwise.
Return
Embedded
Table
Chart
Builder
— This builder, useful for chaining.
enable
Paging(pageSize)
Enables paging and sets the number of rows in each page.
The default page size is 10.
// Creates a table chart builder and enables paging with page size of 5.
const
builder
=
Charts
.
newTableChart
();
builder
.
enablePaging
(
5
);
Parameters
Name
Type
Description
page
Size
Integer
The number of rows in each page of the table.
Return
Embedded
Table
Chart
Builder
— This builder, useful for chaining.
enable
Paging(pageSize, startPage)
Enables paging, sets the number of rows in each page and the first table page to display (page
numbers are zero based).
The default page size is 10, and the default start page is 0.
// Creates a table chart builder and enables paging with page size of 5 and
// displays page 2 first.
const
builder
=
Charts
.
newTableChart
();
builder
.
enablePaging
(
5
,
2
);
Parameters
Name
Type
Description
page
Size
Integer
The number of rows in each page of the table.
start
Page
Integer
The first table page to display (page numbers are zero-based).
Return
Embedded
Table
Chart
Builder
— This builder, useful for chaining.
enable
Rtl
Table(rtlEnabled)
Adds basic support for right-to-left languages (such as Arabic or Hebrew) by reversing the
column order of the table, so that column zero is the right-most column, and the last column is
the left-most column.
This does not affect the column index in the underlying data, only the order of display.
Full bi-directional (BiDi) language display is not supported by the table visualization even
with this option. This option is ignored if you enable paging (using the page option), or if
the table has scroll bars because you have specified height and width options smaller than the
required table size. The default behavior is RTL support disabled.
Parameters
Name
Type
Description
rtl
Enabled
Boolean
true
if right-to-left support should be enabled,
false
otherwise.
Return
Embedded
Table
Chart
Builder
— This builder, useful for chaining.
enable
Sorting(enableSorting)
Sets whether to sort columns when the user clicks a column heading.
If sorting is enabled, when users click on the column header the rows are automatically
sorted. The default behavior is sorting enabled.
Parameters
Name
Type
Description
enable
Sorting
Boolean
true
to enable sorting by clicking on column headers,
false
otherwise.
Return
Embedded
Table
Chart
Builder
— This builder, useful for chaining.
get
Chart
Type()
Returns the current chart type.
Return
Chart
Type
— The chart type.
get
Container()
Return the chart
Container
Info
, which encapsulates where the chart appears on the
sheet.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
chartBuilder
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
sheet
.
getRange
(
'A1:B8'
))
.
setPosition
(
5
,
5
,
0
,
0
);
// This method returns the exact same data as Chart#getContainerInfo()
const
containerInfo
=
chartBuilder
.
getContainer
();
// Logs the values used in setPosition()
Logger
.
log
(
'Anchor Column: %s\r\nAnchor Row %s\r\nOffset X %s\r\nOffset Y %s'
,
containerInfo
.
getAnchorColumn
(),
containerInfo
.
getAnchorRow
(),
containerInfo
.
getOffsetX
(),
containerInfo
.
getOffsetY
(),
);
Return
Container
Info
— An object containing the chart container's position.
get
Ranges()
Returns a copy of the list of ranges currently providing data for this chart. Use
add
Range(range)
and
remove
Range(range)
to modify this list.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
chartBuilder
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
sheet
.
getRange
(
'A1:B8'
))
.
setPosition
(
5
,
5
,
0
,
0
);
const
ranges
=
chartBuilder
.
getRanges
();
// There's only one range as a data source for this chart,
// so this logs "A1:B8"
for
(
const
i
in
ranges
)
{
const
range
=
ranges
[
i
];
Logger
.
log
(
range
.
getA1Notation
());
}
Return
Range[]
— An array of ranges that serve as the chart to be built's data source.
remove
Range(range)
Removes the specified range from the chart this builder modifies. Does not throw an error if
the range is not in this chart.
The range removed must match up with a range added via
add
Range(range)
;
otherwise no change is made to the chart. This method cannot be used to partially remove values
from a range.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
firstRange
=
sheet
.
getRange
(
'A1:B5'
);
const
secondRange
=
sheet
.
getRange
(
'A6:B8'
);
const
chartBuilder
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
firstRange
)
// This range renders in a different color
.
addRange
(
secondRange
)
.
setPosition
(
5
,
5
,
0
,
0
);
// Note that you can use either of these two formats, but the range
// MUST match up with a range that was added via addRange(), or it
// is not removed, and does not throw an exception
chartBuilder
.
removeRange
(
firstRange
);
chartBuilder
.
removeRange
(
sheet
.
getRange
(
'A6:B8'
));
const
chart
=
chartBuilder
.
build
();
sheet
.
insertChart
(
chart
);
Parameters
Name
Type
Description
range
Range
The range to remove.
Return
Embedded
Chart
Builder
— This builder, for chaining.
set
Chart
Type(type)
Changes the type of chart. Not all embedded chart types are currently supported. See
Chart
Type
.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
range
=
sheet
.
getRange
(
'A1:B5'
);
const
chart
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
range
)
.
setPosition
(
5
,
5
,
0
,
0
)
.
build
();
sheet
.
insertChart
(
chart
);
Parameters
Name
Type
Description
type
Chart
Type
The type to change this chart into.
Return
Embedded
Chart
Builder
— This builder, for chaining.
set
First
Row
Number(number)
Sets the row number for the first row in the data table.
The default row number of the first row is 1.
// Creates a table chart builder and sets the first row to be 2.
const
builder
=
Charts
.
newTableChart
();
builder
.
setFirstRowNumber
(
2
);
Parameters
Name
Type
Description
number
Integer
The row number for the first row in the data table.
Return
Embedded
Table
Chart
Builder
— This builder, useful for chaining.
set
Hidden
Dimension
Strategy(strategy)
Sets the strategy to use for hidden rows and columns. Defaults to
IGNORE_ROWS
.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
range
=
sheet
.
getRange
(
'A1:B5'
);
const
chart
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
range
)
.
setHiddenDimensionStrategy
(
Charts
.
ChartHiddenDimensionStrategy
.
IGNORE_COLUMNS
,
)
.
setPosition
(
5
,
5
,
0
,
0
)
.
build
();
sheet
.
insertChart
(
chart
);
Parameters
Name
Type
Description
strategy
Chart
Hidden
Dimension
Strategy
The strategy to use for hidden rows and columns.
Return
Embedded
Chart
Builder
— This builder, for chaining.
set
Initial
Sorting
Ascending(column)
Sets the index of the column according to which the table should be initially sorted
(ascending).
The column os sorted in ascending order and is marked with a small arrow indicating that.
// Creates a table chart builder and sorts it by the second column (ascending).
const
builder
=
Charts
.
newTableChart
();
builder
.
setInitialSortingAscending
(
2
);
Parameters
Name
Type
Description
column
Integer
The number of the column according to which the table should be initially sorted.
Return
Embedded
Table
Chart
Builder
— This builder, useful for chaining.
set
Initial
Sorting
Descending(column)
Sets the index of the column according to which the table should be initially sorted
(descending).
The column os sorted in descending order and is marked with a a small arrow indicating that.
// Creates a table chart builder and sorts it by the second column (descending).
const
builder
=
Charts
.
newTableChart
();
builder
.
setInitialSortingDescending
(
2
);
Parameters
Name
Type
Description
column
Integer
The number of the column according to which the table should be initially sorted.
Return
Embedded
Table
Chart
Builder
— This builder, useful for chaining.
set
Merge
Strategy(mergeStrategy)
Sets the merge strategy to use when more than one range exists. If
MERGE_ROWS
, rows are merged; if
MERGE_COLUMNS
, columns are merged. Defaults to
MERGE_COLUMNS
.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
range
=
sheet
.
getRange
(
'A1:B10'
);
const
range2
=
sheet
.
getRange
(
'C:C10'
);
const
chart
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
range
)
.
addRange
(
range2
)
.
setMergeStrategy
(
Charts
.
ChartMergeStrategy
.
MERGE_ROWS
)
.
setPosition
(
5
,
5
,
0
,
0
)
.
build
();
sheet
.
insertChart
(
chart
);
Parameters
Name
Type
Description
merge
Strategy
Chart
Merge
Strategy
The merge strategy to use.
Return
Embedded
Chart
Builder
— This builder, for chaining.
set
Num
Headers(headers)
Sets the number of rows or columns of the range that should be treated as headers.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
range
=
sheet
.
getRange
(
'A1:B5'
);
const
chart
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
range
)
.
setNumHeaders
(
1
)
.
setPosition
(
5
,
5
,
0
,
0
)
.
build
();
sheet
.
insertChart
(
chart
);
Parameters
Name
Type
Description
headers
Integer
The number of rows or columns to treat as headers. Negative values cause headers
    to be auto-detected.
Return
Embedded
Chart
Builder
— This builder, for chaining.
set
Option(option, value)
Sets advanced options for this chart. To view a list of the available options, see
Chart
configuration options
.
This method doesn't validate the option you specify is valid for this chart type nor if the
value is of the correct format/structure.
This example shows how to change the title and set a legend.
const
spreadsheet
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
spreadsheet
.
getSheets
()[
0
];
const
chart
=
sheet
.
newChart
()
.
setOption
(
'title'
,
'Earnings projections'
)
.
setOption
(
'legend'
,
{
position
:
'top'
,
textStyle
:
{
color
:
'blue'
,
fontSize
:
16
},
}).
build
();
Parameters
Name
Type
Description
option
String
The name of the option.
value
Object
The value of the option.
Return
Embedded
Chart
Builder
— This builder, for chaining.
set
Position(anchorRowPos, anchorColPos, offsetX, offsetY)
Sets the position, changing where the chart appears on the sheet.
anchor
Row
Pos
and
anchor
Col
Pos
are 1-indexed.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
range
=
sheet
.
getRange
(
'A1:B5'
);
const
chart
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
range
)
.
setPosition
(
5
,
5
,
0
,
0
)
.
build
();
sheet
.
insertChart
(
chart
);
Parameters
Name
Type
Description
anchor
Row
Pos
Integer
The chart's top side is anchored in this row.
anchor
Col
Pos
Integer
The chart's left side is anchored in this column.
offsetX
Integer
The chart's upper right-hand corner is offset by this many pixels.
offsetY
Integer
The chart's lower left-hand corner is offset by this many pixels.
Return
Embedded
Chart
Builder
— This builder, for chaining.
set
Transpose
Rows
And
Columns(transpose)
Sets whether the chart's rows and columns are transposed. If set to
true
, the rows and
columns are switched. Defaults to
false
.
const
ss
=
SpreadsheetApp
.
getActiveSpreadsheet
();
const
sheet
=
ss
.
getSheets
()[
0
];
const
range
=
sheet
.
getRange
(
'A1:B5'
);
const
chart
=
sheet
.
newChart
()
.
setChartType
(
Charts
.
ChartType
.
BAR
)
.
addRange
(
range
)
.
setTransposeRowsAndColumns
(
true
)
.
setPosition
(
5
,
5
,
0
,
0
)
.
build
();
sheet
.
insertChart
(
chart
);
Parameters
Name
Type
Description
transpose
Boolean
If
true
, the rows and columns used to construct the chart are
    transposed.
Return
Embedded
Chart
Builder
— This builder, for chaining.
show
Row
Number
Column(showRowNumber)
Sets whether to show the row number as the first column of the table.
The default behavior is not showing row numbers.
Parameters
Name
Type
Description
show
Row
Number
Boolean
true
if the first column of the table should show the row number,
false
otherwise.
Return
Embedded
Table
Chart
Builder
— This builder, useful for chaining.
use
Alternating
Row
Style(alternate)
Sets whether alternating color style is assigned to odd and even rows of a table chart.
The default behavior is the rows having alternating color style.
Parameters
Name
Type
Description
alternate
Boolean
true
if color styles should be alternating,
false
otherwise.
Return
Embedded
Table
Chart
Builder
— This builder, useful for chaining.