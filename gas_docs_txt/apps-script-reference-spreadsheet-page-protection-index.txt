Source Path: gas_docs_html/apps-script/reference/spreadsheet/page-protection/index.html

AI-generated Key Takeaways
outlined_flag
The
PageProtection
class is deprecated and should not be used in new scripts; the
Protection
class is recommended for newer Google Sheets.
This class allows access and modification of protected sheets in the older version of Google Sheets.
Deprecated methods include
addUser()
,
getUsers()
,
isProtected()
,
removeUser()
, and
setProtected()
.
These methods manage the list of users who can edit a protected sheet and set the protection status.
Page
Protection
Deprecated.
For spreadsheets created in the newer version of Google Sheets, use the more powerful
Protection
class instead. Although this class is deprecated, it remains available
    for compatibility with the older version of Sheets.
Access and modify protected sheets in the older version of Google Sheets.
Deprecated methods
Method
Return type
Brief description
add
User(email)
void
Adds a user to the list of users who can edit the sheet, if it is protected.
get
Users()
String[]
Returns a list of the email addresses of the users who can edit this sheet.
is
Protected()
Boolean
Indicates whether the sheet has sheet protection enabled or not.
remove
User(user)
void
Removes a user from the list of users who can edit the sheet.
set
Protected(protection)
void
Sets the protection status for the sheet.
Deprecated methods
add
User(email)
Deprecated.
This function is deprecated and should not be used in new scripts.
Adds a user to the list of users who can edit the sheet, if it is protected.
// Add the "user@example.com" user to the list of users who can edit this sheet
const
sheet
=
SpreadsheetApp
.
getActiveSheet
();
const
permissions
=
sheet
.
getSheetProtection
();
permissions
.
addUser
(
'user@example.com'
);
permissions
.
setProtected
(
true
);
sheet
.
setSheetProtection
(
permissions
);
Parameters
Name
Type
Description
email
String
The email of the user to add.
See also
remove
User(user)
get
Users()
Deprecated.
This function is deprecated and should not be used in new scripts.
Returns a list of the email addresses of the users who can edit this sheet.
If sheet protection is disabled, the value returned by this call is meaningless.
Return
String[]
— An array of email addresses of users who can edit this sheet.
is
Protected()
Deprecated.
This function is deprecated and should not be used in new scripts.
Indicates whether the sheet has sheet protection enabled or not.
// Determine whether or not sheet protection is enabled
const
sheet
=
SpreadsheetApp
.
getActiveSheet
();
const
permissions
=
sheet
.
getSheetProtection
();
const
isProtected
=
permissions
.
isProtected
();
Return
Boolean
— Whether the sheet has sheet protection enabled or not.
See also
set
Protected(protection)
remove
User(user)
Deprecated.
This function is deprecated and should not be used in new scripts.
Removes a user from the list of users who can edit the sheet.
// Remove the "user@example.com" user to the list of users who can edit this
// sheet
const
sheet
=
SpreadsheetApp
.
getActiveSheet
();
const
permissions
=
sheet
.
getSheetProtection
();
permissions
.
removeUser
(
'user@example.com'
);
permissions
.
setProtected
(
true
);
sheet
.
setSheetProtection
(
permissions
);
Parameters
Name
Type
Description
user
String
The email address of the user to remove.
See also
add
User(email)
set
Protected(protection)
Deprecated.
This function is deprecated and should not be used in new scripts.
Sets the protection status for the sheet.
// Enables sheet protection for  this sheet
const
sheet
=
SpreadsheetApp
.
getActiveSheet
();
const
permissions
=
sheet
.
getSheetProtection
();
permissions
.
setProtected
(
true
);
sheet
.
setSheetProtection
(
permissions
);
Parameters
Name
Type
Description
protection
Boolean
true
to enable sheet protection,
false
to disable sheet
    protection.
See also
is
Protected()